expression Page = 1 meta [IsParameterQuery=true, Type="Any", IsParameterQueryRequired=true]
	lineageTag: 14c5a33f-a195-49a7-8f49-e2528ef7b586
	queryGroup: Parameter

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Number

expression Rows = 25 meta [IsParameterQuery=true, Type="Any", IsParameterQueryRequired=true]
	lineageTag: 42cb74ab-469d-45b9-a023-3220681a6120
	queryGroup: Parameter

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Number

expression Dynamic =
		(page as number) =>
		let
		     Source = Json.Document(Web.Contents("https://admin.starwarsunlimited.com/api/card-list?locale=en&pagination[page]=" & Number.ToText(page) & "&pagination[pageSize]=" & Number.ToText(#"Rows") & "")),
		     data = Source[data]
		in
		     data
	lineageTag: f3500b2c-bc7b-43ed-ad35-60ef15409c00
	queryGroup: Function

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Function

expression 'Homepage Links' =
		let
		    #"HTML Code" = Web.BrowserContents("https://nexus.cascadegames.com/"),
		    #"Converted to Table" = #table(1, {{#"HTML Code"}}),
		    ExtractedLinks = Table.TransformColumns(#"Converted to Table", {"Column1", each Text.Split(_, "<a")}),
		    ExpandedLinks = Table.ExpandListColumn(ExtractedLinks, "Column1"),
		    ExtractHyperlinks = Table.AddColumn(ExpandedLinks, "Hyperlink", each Text.BetweenDelimiters([Column1], "href=""", """")),
		    ExtractLinkText = Table.AddColumn(ExtractHyperlinks, "LinkText", each Text.BetweenDelimiters([Column1], ">", "</a>")),
		    CleanedTable = Table.SelectColumns(ExtractLinkText, {"Hyperlink", "LinkText"}),
		    #"Added Custom" = Table.AddColumn(CleanedTable, "Custom", each if Text.StartsWith([Hyperlink], "http") then [Hyperlink] else "https://nexus.cascadegames.com" & [Hyperlink]),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([Hyperlink] <> "#")),
		    #"Renamed Columns" = Table.RenameColumns(#"Filtered Rows",{{"Custom", "WebLink"}})
		in
		    #"Renamed Columns"
	lineageTag: 321aee7b-6ff3-42cd-8011-d1d9ea36e5e1
	queryGroup: 'Cacade Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression 'Resource Links' =
		let
		    #"HTML Code" = Web.BrowserContents("https://nexus.cascadegames.com/resources/"),
		    #"Converted to Table" = #table(1, {{#"HTML Code"}}),
		    ExtractedLinks = Table.TransformColumns(#"Converted to Table", {"Column1", each Text.Split(_, "<a")}),
		    ExpandedLinks = Table.ExpandListColumn(ExtractedLinks, "Column1"),
		    ExtractHyperlinks = Table.AddColumn(ExpandedLinks, "Hyperlink", each Text.BetweenDelimiters([Column1], "href=""", """")),
		    ExtractLinkText = Table.AddColumn(ExtractHyperlinks, "LinkText", each Text.BetweenDelimiters([Column1], ">", "</a>")),
		    CleanedTable = Table.SelectColumns(ExtractLinkText, {"Hyperlink", "LinkText"}),
		    #"Added Custom" = Table.AddColumn(CleanedTable, "Custom", each if Text.StartsWith([Hyperlink], "http") then [Hyperlink] else "https://nexus.cascadegames.com" & [Hyperlink]),
		    #"Filtered Rows" = Table.SelectRows(#"Added Custom", each ([Hyperlink] <> "#")),
		    #"Renamed Columns" = Table.RenameColumns(#"Filtered Rows",{{"Custom", "WebLink"}})
		in
		    #"Renamed Columns"
	lineageTag: 15aa0470-41e9-44b1-a8c7-01bf344200d9
	queryGroup: 'Cacade Tables'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

